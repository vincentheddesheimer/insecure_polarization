<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vincent">

<title>Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="LISS_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="LISS_report_files/libs/quarto-html/quarto.js"></script>
<script src="LISS_report_files/libs/quarto-html/popper.min.js"></script>
<script src="LISS_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="LISS_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="LISS_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="LISS_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="LISS_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="LISS_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="LISS_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link active" data-scroll-target="#key-takeaways">Key takeaways</a></li>
  <li><a href="#why-liss" id="toc-why-liss" class="nav-link" data-scroll-target="#why-liss">Why LISS?</a></li>
  <li><a href="#treatment-variables" id="toc-treatment-variables" class="nav-link" data-scroll-target="#treatment-variables">Treatment Variables</a></li>
  <li><a href="#outcome-variables" id="toc-outcome-variables" class="nav-link" data-scroll-target="#outcome-variables">Outcome variables</a>
  <ul class="collapse">
  <li><a href="#partisan-affect" id="toc-partisan-affect" class="nav-link" data-scroll-target="#partisan-affect">Partisan Affect</a></li>
  <li><a href="#weighted-spread" id="toc-weighted-spread" class="nav-link" data-scroll-target="#weighted-spread">Weighted Spread</a></li>
  <li><a href="#weighted-distance" id="toc-weighted-distance" class="nav-link" data-scroll-target="#weighted-distance">Weighted Distance</a></li>
  </ul></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#unemployment" id="toc-unemployment" class="nav-link" data-scroll-target="#unemployment">Unemployment</a></li>
  <li><a href="#income-decrease" id="toc-income-decrease" class="nav-link" data-scroll-target="#income-decrease">Income Decrease</a></li>
  <li><a href="#drastic-income-decrease-at-least-two-points" id="toc-drastic-income-decrease-at-least-two-points" class="nav-link" data-scroll-target="#drastic-income-decrease-at-least-two-points">Drastic Income Decrease (at least two points)</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><img src="images/incdec2p_results.png" class="img-fluid"></a></li>
  <li><a href="#household-income-decrease-25" id="toc-household-income-decrease-25" class="nav-link" data-scroll-target="#household-income-decrease-25">Household income decrease (25%)</a></li>
  </ul></li>
  <li><a href="#mechanism" id="toc-mechanism" class="nav-link" data-scroll-target="#mechanism">Mechanism</a>
  <ul class="collapse">
  <li><a href="#generalized-trust" id="toc-generalized-trust" class="nav-link" data-scroll-target="#generalized-trust">Generalized trust</a></li>
  <li><a href="#aversion-to-outgroup-interaction" id="toc-aversion-to-outgroup-interaction" class="nav-link" data-scroll-target="#aversion-to-outgroup-interaction">Aversion to outgroup interaction</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vincent </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key takeaways</h2>
<p><strong>Analysis of LISS panel survey data (same individual survey in multiple years):</strong></p>
<ul>
<li><p>Advantages: allows for robust causal identification</p></li>
<li><p>Survey includes both questions that allow us to construct measures of affective polarization and measures of out-group risk aversion</p></li>
<li><p>We can use multiple treatments of economic insecurity: (1) unemployment, (2) individual income decrease, (3) household income decrease</p></li>
</ul>
<p><strong>Results</strong>:</p>
<ul>
<li><p>Shocks to individuals’ economic security increase their affective polarization!</p></li>
<li><p>So far, I was not able to establish that this is because of increased outgroup risk aversion</p></li>
</ul>
</section>
<section id="why-liss" class="level2">
<h2 class="anchored" data-anchor-id="why-liss">Why LISS?</h2>
<p><strong>Background:</strong></p>
<p>The LISS (Longitudinal Internet studies for the Social Sciences) is a panel survey that consists of 5,000 households, comprising approx. 7,500 individuals. It is based on a true probability sample of households drawn from&nbsp;the population register by Statistics Netherlands.</p>
<p>Panel members complete online questionnaires every month of about 15 to 30 minutes in total. They are paid for each completed questionnaire. One member in the household provides the household data and updates this information at regular time intervals.</p>
<p>The core longitudinal study is repeated yearly and is designed to follow changes in the life course and living conditions of the panel members.</p>
<p><strong>Why is this useful?</strong></p>
<p>Panel data is among the strongest data types when it comes to causal inference. Panel data allows the researcher to configure a <em>within</em>-subject research design that tracks individuals during an extended period of economic volatility.</p>
<p>These kinds of research designs are superior to cross-sectional survey data in which scholars find correlations between measures of survey respondents’ economic standing and their political views. With this type of evidence a causal link between the two measures remains unclear: It could be that individuals’ economic circumstances shape their attitudes; Yet it is also plausible that an unobservable characteristic—such as people’s upbringing, or the influence of their parents—explains their political preferences and their standing in economic context (see <a href="https://www.cambridge.org/core/journals/american-political-science-review/article/explaining-social-policy-preferences-evidence-from-the-great-recession/AFA064F23C81B4DF4840A0148F4C2A64">Margalit 2013</a>).</p>
</section>
<section id="treatment-variables" class="level2">
<h2 class="anchored" data-anchor-id="treatment-variables">Treatment Variables</h2>
<p>I construct four different treatment variables that capture some form of increased economic insecurity.</p>
<ol type="1">
<li><p><strong>Unemployment:</strong> An individual is treated in a time period if she is unemployed.</p></li>
<li><p><strong>Income decrease</strong>: The LISS includes a variable where individuals assert under which category they fall income-wise. An individual is treated if the indicated income category is lower in a given year compared to the previous year.</p></li>
<li><p><strong>Substantial income decrease</strong>: The same variable as before is used, but now an individual is treated when the indicated income category is at least <strong>two levels</strong> lower in a given year compared to the previous year.</p></li>
<li><p><strong>Household income decrease</strong>: Because economic (in)security can also depend on the economic situation of other household members (such as one’s partner), this variable indicates that an individual is treated if her household income falls by at least 25% as compared to the previous year.</p></li>
</ol>
</section>
<section id="outcome-variables" class="level2">
<h2 class="anchored" data-anchor-id="outcome-variables">Outcome variables</h2>
<p>I construct three different outcome variables that capture affective polarization.</p>
<section id="partisan-affect" class="level3">
<h3 class="anchored" data-anchor-id="partisan-affect">Partisan Affect</h3>
<p>This is constructed following <a href="https://direct.mit.edu/rest/article-abstract/doi/10.1162/rest_a_01160/109262/Cross-Country-Trends-in-Affective-Polarization">Boxell, Gentzkow, Shapiro (2022)</a> and is very similar to the measures by <a href="https://www.cambridge.org/core/elements/abs/american-affective-polarization-in-comparative-perspective/1E3584B482D51DB25FFFB37A8044F204">Gidron et al (2020)</a> and <a href="https://ejpr.onlinelibrary.wiley.com/doi/full/10.1111/1475-6765.12351">Reiljan (2020)</a>.</p>
<p>It reflects the extent to which an individual expresses a more favorable attitude toward her own party than toward other parties. This is based on questions about party identification (for defining her own party) and on thermometer scores for all parties.</p>
<p>In particular, we code an individual’s party affection based on two questions:</p>
<ul>
<li><p>“Which political party are you an adherent of?”</p></li>
<li><p>“Do you feel more attracted to one of the political parties than to others?”</p></li>
</ul>
<p>If an individual indicates a specific party for any of the two questions (the first question being treated as first order), we code her to be a partisan of that party.</p>
<p>For the thermometer scores we use the following question:</p>
<ul>
<li>“What do you think of the [party name]?”</li>
</ul>
<p>Respondents can choose from a 0-10 discrete scale where 0 is “very unsympathetic” and 10 “very sympathetic”.</p>
<p>From this, we calculate the thermometer score of respondents for each party.</p>
<p>For a partisan’s “ingroup score” we choose the thermometer score of the partisan with respect to her own party. Note, that in a very small number of cases respondents are coded as partisans of more than one party. We then select the party based on the highest thermometer score for a respective individual.</p>
<p>For the final partisan affect measure, we calculate the distance between the thermometer score for the ingroup party (<span class="math inline">\(like_{ip(i)t}\)</span>) and each outgroup party (<span class="math inline">\(like_{ip't}\)</span>) , weight this distance by the outgroup party’s respective vote share in the last parliamentary election, and sum these weighted scores across all parties for each individual.</p>
<p><span class="math display">\[
\text{Partisan Affect}_{it} = \sum_{p' \in P_t\backslash p(i)} \frac{v_{p'}}{v_{P_t}-v_{p(i)}}\left(like_{ip(i)t}-like_{ip't}\right).
\]</span></p>
</section>
<section id="weighted-spread" class="level3">
<h3 class="anchored" data-anchor-id="weighted-spread">Weighted Spread</h3>
<p>The major weakness of the above described measure is that it captures affective polarization only among self-declared partisans. In the LISS data, only 36% indicate that they are either an adherent of or attracted to a party.</p>
<p>Therefore, we also construct two additional measures proposed by <a href="https://www.sciencedirect.com/science/article/abs/pii/S0261379420300822">Wagner (2021)</a>.</p>
<p>First, we calculate affective polarization as the weighted average party affect difference compared to each respondent’s weighted average party affect.</p>
<p><span class="math display">\[\text{Spread}_{it} = \sqrt{\sum_{p=1}^{P_t} \frac{v_{p_t}}{v_{P_t}}\left({like}_{ipt}-\overline{{like}_{it}}\right)^2}.
\]</span></p>
<p>where the mean affect is calculated as a weighted mean:</p>
<p><span class="math display">\[
\overline{{like}_{it}} = \sum^{P_t}_{p=1}\left(v_{p_t} \times like_{ipt}\right).
\]</span></p>
</section>
<section id="weighted-distance" class="level3">
<h3 class="anchored" data-anchor-id="weighted-distance">Weighted Distance</h3>
<p>The second measure conceives affective polarization as the average affective distance of other parties from one’s most liked party. It captures how much lower on average an individual’s affect for other parties is:</p>
<p><span class="math display">\[\text{Distance}_{it} = \sqrt{\sum_{p=1}^{P_t} \frac{v_{p_t}}{v_{P_t}}\left({like}_{ipt}-{like}_{max,it}\right)^2}.
\]</span></p>
</section>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<p>We employ the matching estimator designed by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ajps.12685">Imai, Kim, and Wang (2021)</a>. In particular, we construct a matched set of treatment and control units based on pre-treatment control observations and outcome variable trends from units in the same time period that have an identical treatment history up to four years before treatment. We use covariate balacing propensity score weighting to construct the matched set. We allow for treatment reversal as units can become employed again or increase their income after having experienced an economic shock. We then employ a difference-in-differences estimator to estimate the average treatment effect for the treated (ATT). For pre-treatment control observations we use respondents’ age, education, number of children, whether they have a partner, and monthly income in the year before treatment (to avoid post-treatment bias).</p>
<p>The advantage of this method compared to other methods for analyzing panel data (such as recent estimators proposed for the study of staggered policy adoptions) is that it allows respondents to be treated at any point in time, and repondents to switch their treatment status multiple times over time.</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>The following plots show the average treatment effect for the treated at the time of treatment and the next four years.</p>
<section id="unemployment" class="level3">
<h3 class="anchored" data-anchor-id="unemployment">Unemployment</h3>
<p><img src="images/unemp_results.png" class="img-fluid"></p>
</section>
<section id="income-decrease" class="level3">
<h3 class="anchored" data-anchor-id="income-decrease">Income Decrease</h3>
<p><img src="images/incdec_results.png" class="img-fluid"></p>
</section>
<section id="drastic-income-decrease-at-least-two-points" class="level3">
<h3 class="anchored" data-anchor-id="drastic-income-decrease-at-least-two-points">Drastic Income Decrease (at least two points)</h3>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"><img src="images/incdec2p_results.png" class="img-fluid"></h3>
</section>
<section id="household-income-decrease-25" class="level3">
<h3 class="anchored" data-anchor-id="household-income-decrease-25">Household income decrease (25%)</h3>
<p><img src="images/incdechh_results.png" class="img-fluid"></p>
</section>
</section>
<section id="mechanism" class="level2">
<h2 class="anchored" data-anchor-id="mechanism">Mechanism</h2>
<p>Our theory predicts that affective polarization decreases because people seek lower-risk in-group interactions and shy away from more risky out-group interactions when the economic environment favors risk aversion (see <a href="https://www.science.org/doi/10.1126/sciadv.abd4201">Bryson et al., 2020</a>).</p>
<p>As mentioned above, one advantage of the LISS data is that apart from containing questions that allow us to measure affective polarization it also contains questions that we can use to operationalize aversion to out-group interaction.</p>
<p>In particular, we construct the following two measures:</p>
<section id="generalized-trust" class="level3">
<h3 class="anchored" data-anchor-id="generalized-trust">Generalized trust</h3>
<p>Generalized trust is measured on a 10 point scale:</p>
<ul>
<li>“Generally speaking, would you say that most people can be trusted, or that you can't be too careful in dealing with people? Please indicate a score of 0 to 10.”</li>
</ul>
</section>
<section id="aversion-to-outgroup-interaction" class="level3">
<h3 class="anchored" data-anchor-id="aversion-to-outgroup-interaction">Aversion to outgroup interaction</h3>
<p>Next, we construct a measure that captures individuals’ aversion to outgroup interaction. This is constructed by conducting a principal component analysis (PCA) - a dimension-reduction technique that projects high-dimensional data onto a low-dimensional space and parametrically assigns differential weights to each question - to systematically uncover a latent dimension of aversion to outgroup interaction. We use multiple questions that should capture one’s aversion:</p>
<ul>
<li>“Generally speaking, would you say that most people can be trusted, or that you can't be too careful in dealing with people? Please indicate a score of 0 to 10.”</li>
</ul>
<!-- -->
<ul>
<li><p>“I feel little concern for others”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I am interested in people”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I feel comfortable around people”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I insult people”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I sympathize with others’ feelings”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I am not interested in other peoples’ problems”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I talk to a lot of different people at parties”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I am not really interested in others”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I feel others’ emotions”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“I am quiet around strangers”: 1 (very inaccurate)-5 (very accurate)</p></li>
<li><p>“Which values act as a guiding principle in your life and which values are less important to you? - Open-minded”: 1 extremely unimportant - 7 extremely important</p></li>
<li><p>“Please indicate to what extent you generally feel connected to other people”: 1 not connected (circle) - 7 very connected (circle)</p></li>
</ul>
<p>We reduce each respondents answers to these questions to one dimension via PCA (explains 35% variation). Higher values denote lower risk aversion towards out group. Lower values denote higher risk aversion towards out group.</p>
<p>We use the same matching DiD estimator as above.</p>
<section id="unemployment-1" class="level4">
<h4 class="anchored" data-anchor-id="unemployment-1">Unemployment</h4>
<p><img src="images/unemp_results_mechanisms.png" class="img-fluid"></p>
</section>
<section id="income-decrease-1" class="level4">
<h4 class="anchored" data-anchor-id="income-decrease-1">Income decrease</h4>
<p><img src="images/incdec_results_mechanisms.png" class="img-fluid"></p>
</section>
<section id="drastic-income-decrease" class="level4">
<h4 class="anchored" data-anchor-id="drastic-income-decrease">Drastic income decrease</h4>
<p><img src="images/incdec2p_results_mechanisms.png" class="img-fluid"></p>
</section>
<section id="household-income-decrease" class="level4">
<h4 class="anchored" data-anchor-id="household-income-decrease">Household income decrease</h4>
<p><img src="images/incdechh_results_mechanisms.png" class="img-fluid"></p>
<p>Evidently, economic insecurity does not significantly change people’s risk aversion towards the outgroup in these models. The results are oftentimes insignificant and sometimes even contrary to our expectations.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>